<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Open Source Virtual Backgrounds</title>
    <script src="main.js"></script>
</head>
<body>

<video id="inVideo" muted crossorigin="anonymous"  autoplay></video>
<video id="outVideo" muted crossorigin="anonymous"  autoplay></video>

<img src="https://i.imgur.com/YWgPhxW.jpeg" crossorigin="anonymous" id="background" onclick="changeBackground(this);">

<script>

    async  function run(){

        const stream = await navigator.mediaDevices.getUserMedia({video:true});
        const filter = new BackgroundFilter(stream, {background: document.getElementById('background')});
        const outputStream =  await filter.getOutput();

        window.filter = filter;


        document.getElementById('inVideo').srcObject = stream;
        document.getElementById('outVideo').srcObject = outputStream;
    }


    window.changeBackground = function (background){
        window.filter.changeBackground(background);
    }


    run();



</script>


</body>
</html>